<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">

  <changeSet id="000" author="petrov">
    <addColumn schemaName="metadata" tableName="db_connection">
      <column name="driver_class_name" type="varchar(255)" remarks="Имя класса jdbc-драйвера"/>
    </addColumn>

    <sql>
      update metadata.db_connection set driver_class_name = 'org.postgresql.Driver';
    </sql>

    <addNotNullConstraint schemaName="metadata" tableName="db_connection" columnName="driver_class_name"/>
  </changeSet>

  <changeSet id="001" author="abdulin">
    <createTable tableName="editable_tree_grid" schemaName="metadata" remarks="Таблица с параметрами ">
      <column name="editable_tree_grid_id" type="bigint" autoIncrement="true">
        <constraints primaryKey="true" primaryKeyName="pk_editable_tree_grid"/>
      </column>
      <column name="table_id" type="varchar(100)">
        <constraints nullable="false" unique="true" uniqueConstraintName="uni_editable_tree_grid1"/>
      </column>
      <column name="business_rule" type="text"></column>
    </createTable>
  </changeSet>

  <changeSet id="002" author="abdulin">
    <addColumn tableName="editable_tree_grid" schemaName="metadata">
      <column name="css_class" type="text" remarks="Функция для получения css"></column>
    </addColumn>
  </changeSet>

  <changeSet id="003" author="abdulin">
    <addColumn tableName="editable_tree_grid" schemaName="metadata">
      <column name="dependency_matrix" type="text" remarks="Матрица зависимостей"></column>
    </addColumn>
  </changeSet>
  
  <changeSet id="002" author="golovlyev">
    <addColumn schemaName="metadata" tableName="editable_tree_grid">
      <column name="editable_rule" type="text" remarks="Функция для задания условия редактируемости ячейки"/>
    </addColumn>
  </changeSet>

</databaseChangeLog>