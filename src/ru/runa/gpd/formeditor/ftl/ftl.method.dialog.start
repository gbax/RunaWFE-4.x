
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<title>Properties</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<script type="text/javascript" src="prototype.js"></script>
		<script language="javascript">

var oEditor = window.parent.InnerDialogLoaded() ;
var FCKLang = oEditor.FCKLang ;
var varTags = oEditor.FreemarkerTags;
var tagName;

window.onload = function () {
	// First of all, translate the dialog box texts
	oEditor.FCKLanguageManager.TranslatePage( document ) ;
	
	if (!LoadSelected()) {
		refreshExtra();
	}
	
	Event.observe("tagName", "change", refreshExtra);
	// Show the "Ok" button.
	window.parent.SetOkButton( true ) ;
}

var eSelected = oEditor.FCKSelection.GetSelectedElement() ;

function LoadSelected() {
	if ( !eSelected || !eSelected.getAttribute("ftltagparams") ) {
		eSelected == null;
		return false;
	}
	tagName = eSelected.getAttribute("ftltagname");
	$("tagName").value = tagName;
	refreshExtra();

	var paramsStr = eSelected.getAttribute("ftltagparams");
	var paramsArray = paramsStr.split("|");
	for (var i=0; i<paramsArray.length; i++) {
		var combo = $("pc_"+i);
		if (combo != null) {
			combo.value = paramsArray[i];
			if (combo.value != paramsArray[i]) {
				combo = null;
			}
		} else { 
			var text = $("pc_"+i);
			if (text != null) {
				text.value = paramsArray[i];
			}
		}
	}
	return true;
}

function refreshExtra() {
	if ($("tagName").value.length > 0) {
		tagName = $("tagName").value;
	}
	var text = varTags.GetParameters(tagName);
	$("extra").update(text);
}

function Ok() {
	var tagType = $("tagName").value;
	if ( tagType.length == 0 ) {
		alert( FCKLang.ErrNoTagType ) ;
		return false ;
	}
	var tagParams = "";
	var ex = false;
	for (var i=0; i<100; i++) {
		var v;
		var combo = $("pc_" + i);
		var text = $("pt_" + i);
		if (combo == null && text == null) {
			break;
		}
		if (combo != null && combo.value.length > 0) {
			v = combo.value;
		} else if (text != null) {
			v = text.value;
		}
		if ( v == null ) {
			alert( FCKLang.ErrNotAllParamsSet ) ;
			return false;
		}
		if (ex) {
			tagParams += "|";
		}
		tagParams += v;
		ex = true;
	}
	varTags.AddMethod ( tagType, tagParams );
	return true ;
}

		</script>
	</head>
	<style>
	 .leftParam {
	   width: 40%;
	 }
	 .rightParam {
	   width: 60%;
	 }
	 select {
	   width: 100%;
	 }
	</style>
	<body style="overflow: auto;">
		<table style="width: 100%; height: 100%; border: 0px; vertical-align: top;">
			<tr>
				<td style="vertical-align: top;">
					<select id="tagName" style="width: 100%;">

