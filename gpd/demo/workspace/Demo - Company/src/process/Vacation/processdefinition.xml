<?xml version="1.0" encoding="UTF-8"?>
<process-definition name="Vacation" xmlns="urn:jbpm.org:jpdl-3.2">
  <description><![CDATA[Participants of this process are members of  manager, all and human resource groups]]></description>
  <swimlane name="human resource inspector">
    <assignment
      class="ru.runa.wf.jbpm.delegation.assignment.AssignmentHandler" config-type="configuration-property"><![CDATA[ru.runa.af.organizationfunction.ExecutorByNameFunction(human resource)]]></assignment>
  </swimlane>
  <swimlane name="boss">
    <assignment
      class="ru.runa.wf.jbpm.delegation.assignment.AssignmentHandler" config-type="configuration-property"><![CDATA[ru.runa.af.organizationfunction.DemoChiefFunction(${requester})]]></assignment>
  </swimlane>
  <swimlane name="requester">
    <assignment
      class="ru.runa.wf.jbpm.delegation.assignment.AssignmentHandler" config-type="configuration-property"><![CDATA[]]></assignment>
  </swimlane>
  <start-state name="Request for a vacation">
    <description><![CDATA[Requester starts a vacation request process]]></description>
    <task name="Request for a vacation" swimlane="requester"/>
    <transition name="tr1" to="Evaluate a request"/>
  </start-state>
  <decision name="Is approved?">
    <handler
      class="ru.runa.wf.jbpm.delegation.decision.BSFDecisionHandler" config-type="configuration-property"><![CDATA[if ( bossDecision.booleanValue() == false ) {
	return "rejected";
}

return "approved";
]]></handler>
    <transition name="approved" to="Check rules and technologies"/>
    <transition name="rejected" to="Notify of rejection"/>
  </decision>
  <decision name="Is correct?">
    <handler
      class="ru.runa.wf.jbpm.delegation.decision.BSFDecisionHandler" config-type="configuration-property"><![CDATA[if ( humanResourceInspectorCheckResult.booleanValue() == false ) {
	return "not correct";
}

return "correct";
]]></handler>
    <transition name="correct" to="fork"/>
    <transition name="not correct" to="Evaluate a request"/>
  </decision>
  <task-node name="Evaluate a request">
    <description><![CDATA[Evaluate a vacation request]]></description>
    <task name="Evaluate a request" swimlane="boss"/>
    <transition name="tr1" to="Is approved?"/>
  </task-node>
  <task-node name="Check rules and technologies">
    <description><![CDATA[Check that all is correct]]></description>
    <task name="Check rules and technologies" swimlane="human resource inspector"/>
    <transition name="tr1" to="Is correct?"/>
  </task-node>
  <task-node name="Notify of rejection">
    <description><![CDATA[The request is rejected]]></description>
    <task name="Notify of rejection" swimlane="requester"/>
    <transition name="tr1" to="end"/>
  </task-node>
  <task-node name="Submit a hardcopy request">
    <description><![CDATA[Submit a written request for vacation to the human resource department]]></description>
    <task name="Submit a hardcopy request" swimlane="requester"/>
    <transition name="tr1" to="join"/>
  </task-node>
  <task-node name="Receive a hardcopy request">
    <description><![CDATA[Receive a written request for vacation from the employee]]></description>
    <task name="Receive a hardcopy request" swimlane="human resource inspector"/>
    <transition name="tr1" to="join"/>
  </task-node>
  <task-node name="Make an official order">
    <description><![CDATA[Make an official order for vacation]]></description>
    <task name="Make an official order" swimlane="human resource inspector"/>
    <transition name="tr1" to="end"/>
  </task-node>
  <fork name="fork">
    <transition name="tr1" to="Submit a hardcopy request"/>
    <transition name="tr2" to="Receive a hardcopy request"/>
  </fork>
  <join name="join">
    <transition name="tr1" to="Make an official order"/>
  </join>
  <end-state name="end"/>
</process-definition>
