<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE process-definition PUBLIC
    "-//jBpm/jBpm Mapping DTD 2.0//EN"
    "http://jbpm.org/dtd/processdefinition-2.0.dtd">

<process-definition name="jpdlFork2TestProcess"> 
  <description>This is sample workflow process demonstraiting Decision test.</description>
  <!-- SWIMLANES -->
  <swimlane name="swimlane1" />

  <swimlane name="swimlane2">
    <delegation class="ru.runa.wf.jbpm.delegation.assignment.AssignmentHandler">ru.runa.af.organizationfunction.ExecutorByNameFunction(HrOperator)</delegation>
  </swimlane>

  <swimlane name="swimlane3">
    <delegation class="ru.runa.wf.jbpm.delegation.assignment.AssignmentHandler">ru.runa.af.organizationfunction.ExecutorByNameFunction(ErpOperator)</delegation>
  </swimlane>


<!-- START-STATE -->
<start-state name="start_state" swimlane="swimlane1">
	<transition to="fork_1"/>
</start-state>

<!-- NODES -->

<decision name="decision_1">
	<delegation class="ru.runa.wf.jbpm.delegation.decision.BSFDecisionHandler">
	<![CDATA[
	if(Boolean.valueOf(def_variable).booleanValue())
		return "true_link";
	else
		return "false_link";
	]]>
	</delegation>
	<transition name="false_link" to="state_5"/>
	<transition name="true_link" to="fork_3"/>
</decision>

<state name="state_1">
	<assignment swimlane="swimlane2" assignment="required" />
	<transition to="decision_1"/>
</state>

<state name="state_2">
	<assignment swimlane="swimlane3" assignment="required" />
	<transition to="fork_2"/>
</state>

<state name="state_3">
	<assignment swimlane="swimlane2" assignment="required" />
	<transition to="join_3"/>
</state>

<state name="state_4">
	<assignment swimlane="swimlane3" assignment="required" />
	<transition to="join_3"/>
</state>

<state name="state_5">
	<assignment swimlane="swimlane2" assignment="required" />
	<transition to="join_1"/>
</state>

<state name="state_6">
	<assignment swimlane="swimlane1" assignment="required" />
	<transition to="join_1"/>
</state>

<state name="state_7">
	<assignment swimlane="swimlane3" assignment="required" />
	<transition to="join_2"/>
</state>

<state name="state_8">
	<assignment swimlane="swimlane1" assignment="required" />
	<transition to="done"/>
</state>

<fork name="fork_1">
	<transition to="state_1" />
	<transition to="state_2" />
</fork>

<join name="join_1">
	<transition to="state_8" />
</join>

<fork name="fork_2">
	<transition to="fork_3" />
	<transition to="state_7" />
</fork>

<join name="join_2">
	<transition to="state_6" />
</join>

<fork name="fork_3">
	<transition to="state_3" />
	<transition to="state_4" />
</fork>

<join name="join_3">
	<transition to="join_2" />
</join>

<!-- END-STATE -->
<end-state name="done" />

</process-definition>